<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Inject Demo FASTGO ‚Äì Corrig√©</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f5f5f5; padding: 40px; }
    h1 { color: #6C63FF; }
    button { background: #6C63FF; color: white; padding: 15px 30px; border: none; border-radius: 8px; font-size: 18px; cursor: pointer; }
    button:hover { background: #5a52d6; }
    .log { margin-top: 20px; background: white; padding: 15px; border-radius: 8px; white-space: pre-wrap; font-size: 14px; }
  </style>
</head>
<body>

  <h1>üöÄ Injecter une demo compl√®te FASTGO (CORRIG√â)</h1>
  <button onclick="injectAll()">Injecter la demo</button>
  <div id="log" class="log"></div>

  <!-- Firebase 9.22.0 ‚Äì URLs OFFICIELLES -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js';
    import {
      getFirestore, doc, setDoc, Timestamp
    } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js';

    const firebaseConfig = {
      apiKey: 'AIzaSyAiROTzgd26gOEEoWra2ADKTviv753cx5Q',
      authDomain: 'yass-drc.firebaseapp.com',
      projectId: 'yass-drc',
      storageBucket: 'yass-drc.appspot.com',
      messagingSenderId: '946442540515',
      appId: '1:946442540515:web:d1b30386ab315e185bcd6',
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // ‚úÖ Rendre disponible globalement
    window.db = db;
    window.Timestamp = Timestamp;
    window.setDoc = setDoc;
    window.doc = doc;
  </script>

  <script>
    const now = () => Timestamp.now();

    async function injectAll() {
      const log = document.getElementById('log');
      log.textContent = '';

      try {
        const orderId = 'TEST_ORddddddddDE_001';
        const sellerId = 'israelntalu328@gmail.com';
        const sellerName = 'israelmukaya';
        const sellerPhone = '+243983627022';
        const buyerName = 'Mbudy ';
        const buyerPhone = '+243999999999';
        const address = 'Q. Masina, dRue 12, Kinshasa';
        const amount = 7500;
        const lat = -5.897000;
        const lng = 22.448833;
        const sellerDepositId = 'vendeudr120_1720000000000';

        // 1. Commande
        const order = {
          id: orderId,
          sellerId,
          customerName: buyerName,
          customerPhone: buyerPhone,
          deliveryAddress: address,
          deliveryCoordinates: { latitude: lat, longitude: lng },
          totalAmount: amount,
          status: 'confirmed',
          paymentStatus: 'pending',
          buyerId: 'buyer123',
          createdAt: now(),
          updatedAt: now()
        };
        await setDoc(doc(window.db, 'orders', orderId), order);
        log.textContent += '‚úÖ Commande cr√©√©e : ' + orderId + '\n';

        // 2. Course FASTGO
        const fastgo = {
          orderId,
          sellerId,
          sellerName,
          sellerPhone,
          buyerName,
          buyerPhone,
          address,
          lat,
          lng,
          amount,
          sellerDepositId,
          qrCodes: {
            airtel: 'https://firebasestorage.googleapis.com/v0/b/yass-drc.firebasestorage.app/o/qr%2Fvendeur123_airtel.png?alt=media&token=fake',
            orange: 'https://firebasestorage.googleapis.com/v0/b/yass-drc.firebasestorage.app/o/qr%2Fvendeur123_orange.png?alt=media&token=fake',
            mpesa: 'https://firebasestorage.googleapis.com/v0/b/yass-drc.firebasestorage.app/o/qr%2Fvendeur123_mpesa.png?alt=media&token=fake'
          },
          status: 'pending',
          createdAt: now(),
          updatedAt: now()
        };
        await setDoc(doc(window.db, 'fastgo_deliveries', orderId), fastgo);
        log.textContent += '‚úÖ Course FASTGO cr√©√©e\n';

        log.textContent += '\nüéâ Tout est pr√™t ! Va dans ton app ‚Üí tu verras la course TEST_ORDER_001.';
      } catch (e) {
        log.textContent += '‚ùå Erreur : ' + e.message;
      }
    }
  </script>

</body>
</html>